<script>
        // Get site ID from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const siteId = urlParams.get('siteId');
        
        if (!siteId) {
            document.getElementById('status').innerHTML = 'Error: No site ID provided';
            document.getElementById('status').className = 'status fallback';
            document.getElementById('fallback').style.display = 'block';
            return;
        }
        
        // Create deep links
        const androidDeepLink = `lendly://join/${siteId}`;
        const iosDeepLink = `lendly://join/${siteId}`;
        
        // Display manual link
        document.getElementById('manualLink').textContent = androidDeepLink;
        
        // Detect platform and attempt to open app
        const userAgent = navigator.userAgent.toLowerCase();
        const isAndroid = /android/.test(userAgent);
        const isIOS = /iphone|ipad|ipod/.test(userAgent);
        
        let deepLink = '';
        if (isAndroid) {
            deepLink = androidDeepLink;
        } else if (isIOS) {
            deepLink = iosDeepLink;
        } else {
            // Default to Android for unknown platforms
            deepLink = androidDeepLink;
        }
        
        // Function to attempt opening the app
        function attemptOpenApp() {
            // Try to open the app
            window.location.href = deepLink;
            
            // Set a timeout to show fallback if app doesn't open
            setTimeout(() => {
                document.getElementById('status').innerHTML = 'App not found or unable to open';
                document.getElementById('status').className = 'status fallback';
                document.getElementById('fallback').style.display = 'block';
            }, 2000);
        }
        
        // Add click handlers for manual opening
        document.addEventListener('DOMContentLoaded', function() {
            // Try to open app immediately
            attemptOpenApp();
            
            // Add click handler for manual link
            document.getElementById('manualLink').addEventListener('click', function(e) {
                e.preventDefault();
                window.location.href = androidDeepLink;
            });
        });
        
        // Handle visibility change (user might have switched to app)
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                // User switched to another app, might be our app
                setTimeout(() => {
                    if (!document.hidden) {
                        // User came back, might want to show success
                        document.getElementById('status').innerHTML = 'If the app opened successfully, you should see the join screen. If not, use the options above.';
                        document.getElementById('status').className = 'status fallback';
                    }
                }, 1000);
            }
        });
    </script>
</body>
</html>
